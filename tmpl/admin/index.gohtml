@{
	import (
		"wanderinglunch/tmpl/helper"
		"wanderinglunch/tmpl/layout/base"
		"wanderinglunch/web"
	)
}

@{
	adminJs := "/static/admin.js?v=" + web.Md5File("admin.js")
}

@section js {
	<script src="@adminJs"></script>
}

@section menu {
	@helper.Menu("adminindex", true)
}

@section htmlTitle {
	return "Admin"
}

<b>Add: </b><a href="/admin/truck/add">Truck</a> | 
<a href="/admin/sub/add">Sub</a> | 
<a href="/admin/ad/add">Ad</a>

<h1>Updated Recently but no address</h1>

<table class="table table-minimal">
	<thead>
		<tr>
			<th>Id</th>
		</tr>
	</thead>
	<tbody data-bind="foreach: trucks">
		<td><a data-bind="attr: { href: '/admin/fix/'+id }"><span data-bind="text: id"></span></a></td>
	</tbody>

</table>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		ko.applyBindings(new Admin());	
	});
	
	function Admin() {
		var self = this;
		self.trucks = ko.observableArray([]);

		$.ajax({
	    	dataType: 'json',
	    	url: API_URL + '/trucks/failures',
	    	xhrFields: {
	      		withCredentials: true
	    	}
	  	}).done(function(data) {
	  		self.trucks(data);
	  	});
	}
</script>